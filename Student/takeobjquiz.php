<?php// STUDENT TAKING OBJ QUIZ (SEPARATE PAGE BECAUSE OF RANDOMIZE)// GET NUMBER OF QUESTIONS IN TABLE// RANDOMIZEinclude '../_includes/database.php';include '../_includes/dbfunctions.php';include '../_includes/generalfunctions.php';session_start();$user = $_SESSION['userid'];$conn = connectDB($hostname,$username,$password,$databaseName); $quizid= $_POST['quiz_id'];$qcount = 1;// CHECK IF QUIZ IS ASSIGNED$checkQuiz="SELECT ass_status FROM quiz_assignment WHERE quiz_id='$quizid' AND user_id='$user'";$getQuizStatus = execQuery($checkQuiz,$conn);if($getQuizStatus != "Assigned")	header("location:studenthome.php");// IF IT IS ASSIGNED, CHANGE IT TO UNMARKEDelse{	// INSERT INTO GRADE QUIZ_ASSIGNMENT	$changeQuiz = "UPDATE quiz_assignment SET ass_status='Marked' WHERE quiz_id='$quizid' AND user_id='$user'";	mysql_query($changeQuiz,$conn);}$getQuizTime = "SELECT timelimit from quiz_detail WHERE quiz_id='$quizid' ";$value= execQuery($getQuizTime,$conn);?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" ><head>        <title>AnswerMe Quiz system</title>    <link href="../_css/styles.css" rel="stylesheet" type="text/css" /><script type="text/javascript" src="../_scripts/timer.js"></script></head><body onload="do_countdown()"><input type="hidden" id="testing" value="<?php echo $value ?>"/><div id="container"><div id="header"><center><img src="../_images/logo.png"  /></center></div><div id="navigation"><ul id="nav">        	<li><a href="studenthome.php">Home</a></li>			<li><a href="viewresults.php">View Results</a></li>			<li><a href="studentprofile.php">Manage Profile</a></li>			<li><a href="../_includes/logout.php">Logout</a></li>    </ul></div>	<div id="content">		<div id="warningdiv"> DO NOT REFRESH PAGE OR CLICK THE BACK BUTTON</div><div id="countdown_div" align="center">&nbsp;</div><form action="../_includes/Student/objquizcompleted.php" method="post" id="formquiz"><?php$checkNoQuest="SELECT no_of_questions from quiz_detail WHERE quiz_id='$quizid'";$noOfQuest=execQuery($checkNoQuest,$conn);$queryCountQ = "SELECT count(question_id) FROM quiz_questions WHERE quiz_id='$quizid' AND question_type='obj'";$qAdded = execQuery($queryCountQ,$conn);$queryQAdded = "SELECT question_id FROM quiz_questions WHERE quiz_id='$quizid' AND question_type='obj'";$qList = resultQuery($queryQAdded,$conn);$questionArray = array();if($qAdded==$noOfQuest){	$randomList=randomize($qAdded-1);}else if($qAdded>$noOfQuest){	$randomList = randomizeTwo($qAdded-1,$noOfQuest);}for($i=0;$i<$noOfQuest;$i++){		for($j=0;$j<1;$j++)	{		$random = $randomList[$i];		$objqid = $qList[$random][0];		$questionArray[] = $objqid;				$getobjq = "SELECT question_text,ans_a,ans_b,ans_c,ans_d FROM obj_questions WHERE question_id='$objqid'";		$getObjQuestions = resultQuery($getobjq,$conn);				for($x=0;$x<count($getObjQuestions);$x++)		{			echo "<div id='objquestion'>";						for($y=0;$y<5;$y++)			{				if($y==0)				{					echo "<p>"."$qcount. ";					echo $getObjQuestions[$x][$y]."<p><br/>";					$qcount++;				}								else				{					$answer = $getObjQuestions[$x][$y];					echo "<input type='radio' name='$objqid' value='$answer'>$answer<br/>";				}							}			echo"</div>";		}	}}for($j=0;$j<count($questionArray);$j++){	$question=$questionArray[$j];	$query="INSERT INTO results VALUES('$user','$quizid','$question','',0)";		mysql_query($query,$conn);}$_SESSION['objquestion']=$questionArray;?><br/><input type="hidden" name="quiz_id" value="<?php echo $quizid ?>"/><input type="submit" name="" value="Submit QUIZ"/></form></div>	<div id="footer"><p>footer here: &copy; 2009 <a href="#" title="Your Company">Your Company</a> | Privacy | Terms of Use</p></div></div></body></html>